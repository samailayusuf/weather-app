<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.22.0/axios.min.js"></script>


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Display&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/styles.css"/>
</head>
<body>
<nav>
    <h2>Forecast</h2>

</nav>



<main>
    <h1>Check The Weather</h1>

        <section class="control-wrapper"><!--- This houses the input form to collect location input-->
            <input type="text" id="city-name" placeholder="Enter City Name"/>
            <button id="button" onclick="fetchWeatherData()">Search</button>
        </section>

    <section class="report">
        <div style="flex:2">
            <h2 style="border-bottom:1px solid #B27092; padding:10px;">Today's report</h2>
            <h3 id="city"> City</h3>
            <h3 id="condition"> Condition </h3>
            <h3 id="temperature"> Temperature &#8451</h3>
        
        </div >
            
        <div id="image" style="flex:1">
        </div>
    </section>

    <section class="forecast">
        <section class="next-day">
            <div style="flex:2">
                <h2 style="border-bottom:1px solid #B27092; padding:10px;">Tomorrow's Forecast</h2>
                <h3 id="next-city"> City</h3>
                <h3 id="next-condition"> Condition </h3>
                <h3 id="next-temperature"> Temperature &#8451</h3>
            
            </div >
                
            <div id="next-image" style="flex:1">
            </div>
        </section>

        <section class="day-after-next">
            <div style="flex:2">
                <h2 style="border-bottom:1px solid #B27092; padding:10px;">Day After Next's Forecast</h2>
                <h3 id="next-forecast-city"> City</h3>
                <h3 id="next-forecast-condition"> Condition </h3>
                <h3 id="next-forecast-temperature"> Temperature &#8451</h3>
            
            </div >
                
            <div id="next-forecast-image" style="flex:1">
            </div>
        </section>

    </section>

</main>
    
    <script>
        function fetchWeatherData() {
    const location = document.querySelector('#city-name').value;

    if(!location) return;
    //Grabbing the UI elements for same day report
    const city = document.querySelector('#city');
    const condition = document.querySelector('#condition');
    const temperature = document.querySelector('#temperature');
    const imageContainer = document.querySelector('#image');

    //Grabbing UI elements for the 1st day forecast
    const forecastCity = document.querySelector('#next-city');
    const forecastCondition = document.querySelector('#next-condition');
    const forecastTemperature = document.querySelector('#next-temperature');
    const forecastImageContainer = document.querySelector('#next-image');

    //Grabbing UI for second day forecast
    const nextForecastCity = document.querySelector('#next-forecast-city');
    const nextForecastCondition = document.querySelector('#next-forecast-condition');
    const nextForecastTemperature = document.querySelector('#next-forecast-temperature');
    const nextForecastImageContainer = document.querySelector('#next-forecast-image');
    //console.log('clicked');
    axios.get(`https://api.weatherapi.com/v1/forecast.json?key=1f88145fbe2e4e788aa101132210110&q=${location}&days=3&aqi=no&alerts=no`).
    then(response =>{

        const conditionText = response.data.current.condition.text;
        const temperatureData = response.data.current.temp_c + ' <span>&#8451</span>';
        const location = response.data.location.name +", "+response.data.location.country;
        const image = response.data.current.condition.icon;

        //Getting 1st day forecast from the api
        const forecastCondtionText = response.data.forecast.forecastday[1].day.condition.text;
        const forecastTemp = `Min: ${response.data.forecast.forecastday[1].day.mintemp_c} <span>&#8451</span> and Max: ${response.data.forecast.forecastday[1].day.maxtemp_c} <span>&#8451</span>` ;
        const forecastIcon = response.data.forecast.forecastday[1].day.condition.icon;

        //Getting data for second day forecast from api
        const nextForecastCondtionText = response.data.forecast.forecastday[2].day.condition.text;
        const nextForecastTemp = `Min: ${response.data.forecast.forecastday[2].day.mintemp_c} <span>&#8451</span> and Max: ${response.data.forecast.forecastday[1].day.maxtemp_c} <span>&#8451</span>` ;
        const nextForecastIcon = response.data.forecast.forecastday[2].day.condition.icon;



        //Inserting data for 1st day forecast from API into UI elements
        forecastCity.innerHTML = location;
        forecastCondition.innerHTML = forecastCondtionText;
        forecastTemperature.innerHTML = forecastTemp;
        forecastImageContainer.innerHTML = `<img src=${forecastIcon} />`;

        //Inserting API data into forecast second day UI elements
        nextForecastCity.innerHTML = location;
        nextForecastCondition.innerHTML = nextForecastCondtionText;
        nextForecastTemperature.innerHTML = nextForecastTemp;
        nextForecastImageContainer.innerHTML = `<img src=${nextForecastIcon} />`;


        
        //Same day's weather report 
        console.log(forecastCondtionText);
        city.innerHTML = location;
        condition.innerText = conditionText;
        temperature.innerHTML = temperatureData;
        imageContainer. innerHTML = `<img src=${image} />`;

    })
    .catch(err =>{
        console.log(err);
    })
}
    </script>
</body>
</html>